File_Name,Code
emailAnalysis.ipynb - Colab-final.pdf,"import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import mailbox
import csv
mboxfile = ""/content/drive/MyDrive/mail/All mail Including Spam and Trash-001 (1).mbox""
mbox = mailbox.mbox(mboxfile)
for key in mbox[0].keys():
 print(key)
with open('mailbox.csv', 'w') as outputfile:
 writer = csv.writer(outputfile)
 writer.writerow(['subject', 'from', 'date', 'to', 'label', 'thread'])
 for message in mbox:
  writer.writerow ([
  message['subject'],
  message['from'],
  message['date'],
  message['to'],
  message['X-Gmail-Labels'],
  message[ 'X-GM-THRID']
])
dfs = pd.read_csv('mailbox.csv', names=['subject', 'from', 'date', 'to', 'label', 'thread'])
dfs.dtypes
dfs['date'] = dfs['date'].apply(lambda x: pd.to_datetime(x, errors='coerce', utc=True))
dfs = dfs[dfs['date'].notna()]
dfs.to_csv('gmail.csv')
dfs.info()
dfs.head(10)
import re
def extract_email_ID(string):
 email = re.findall(r'<(.+?)>', string)
 if not email:
  email = list(filter (lambda y: '@' in y, string.split()))
 return email[0] if email else np.nan
dfs['from'] = dfs['from'].apply(lambda x: extract_email_ID(x))
myemail = 'priyankas.vahin@gmail.com'
dfs['label'] = dfs['from'].apply(lambda x: 'sent' if x==myemail
 else 'inbox')
dfs.drop(columns='to', inplace=True)
dfs.head(10)
import datetime
import pytz
def refactor_timezone(x):
 ist = pytz.timezone ('Asia/Kolkata')
 return x.astimezone(ist)
dfs['date'] = dfs['date'].apply(lambda x: refactor_timezone(x))
dfs
dfs['dayofweek'] = dfs['date'].dt.day_name()
dfs['dayofweek'] = pd.Categorical (dfs['dayofweek'], categories=[
 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday',
  'Saturday', 'Sunday'], ordered=True)
dfs['dayofweek']
dfs['timeofday'] = dfs['date'].apply(lambda x: x.hour + x.minute/60
 + x.second/3600)
dfs['hour'] = dfs['date'].apply(lambda x: x.hour)
dfs['year_int'] = dfs['date'].apply(lambda x: x.year)
dfs['year'] = dfs['date'].apply(lambda x: x.year +x.dayofyear/365.25)
dfs.head(10)
print(dfs.date.min().strftime('%a, %d %b %Y %I:%M%p'))
print(dfs.date.max().strftime('%a, %d %b %Y %I:%M %p'))
print(dfs['label'].value_counts())
dfs['date_only'] = dfs['date'].dt.date
dfs['date_only']
emails_per_day = dfs.groupby('date_only').size().reset_index(name='email_count')
emails_per_day
Average_emails_per_day=(dfs['from'].count())/dfs['date_only'].nunique()
Average_emails_per_day
print(""Average Emails per day:"", Average_emails_per_day)
emails_per_hour_groupby = dfs.groupby('hour')['from'].count()
emails_per_hour_groupby
email_count=dfs['from'].count()
number_of_hours=dfs['date_only'].nunique()*24
Average_emails_per_hour=email_count/number_of_hours
print(""Average Emails per hour:"", Average_emails_per_hour)
counts = dfs.dayofweek.value_counts (sort=False)
counts.plot(kind='bar')
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
sent = dfs[dfs['label']=='sent']
received = dfs [dfs['label']=='inbox']
sdw = sent.groupby('dayofweek').size() / len(sent)
rdw = received.groupby('dayofweek').size() / len(received)
df_tmp = pd.DataFrame(data={'Outgoing Email': sdw, 'Incoming Email':rdw})
df_tmp.plot(kind='bar', rot=45, figsize=(8,5), alpha=0.5)
plt.xlabel('');
plt.ylabel('Fraction of weekly emails')
plt.grid(ls=':', color='k', alpha=0.5)
msg = dfs.subject
msg_split = msg.str.split(expand=True)
msg_split
msg_stack = msg_split.stack()
msg_stack
n_most_frequent_words = 100
msg_word_frequency = msg_stack.value_counts()
top_words = msg_word_frequency.head(n_most_frequent_words)
top_words
import seaborn as sns
import matplotlib.pyplot as plt
plt.figure(figsize=(60, 60))
ax=sns.barplot(x=top_words.values, y=top_words.index)
plt.title(f'Top {n_most_frequent_words} Most Frequent Words')
plt.xlabel('Frequency')
plt.ylabel('Words')
ax.tick_params(axis='y', rotation=90)
plt.tight_layout()
plt.show()"
onlineretail.ipynb - Colab.pdf,"import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
df = pd.read_csv(""/content/online_retail.csv"")
df.head()
df.info()
df.describe()
df.dropna(subset=['CustomerID'], inplace=True)
df = df[(df['Quantity'] > 0) & (df['UnitPrice'] > 0)]
df['CustomerID'] = df['CustomerID'].astype(str)
df['TotalAmount'] = df['Quantity'] * df['UnitPrice']
df['InvoiceDate'] = pd.to_datetime(df['InvoiceDate'])
df['PurchaseMonth'] = df['InvoiceDate'].dt.month
df['PurchaseYear'] = df['InvoiceDate'].dt.year
top_countries = df.groupby('Country')['TotalAmount'].sum().sort_values(ascending=False).head(10)
avg_order_value_per_country = df.groupby('Country')['TotalAmount'].mean().sort_values(ascending=False).head(10)
plt.figure(figsize=(12,6))
sns.barplot(x=avg_order_value_per_country.index, y=avg_order_value_per_country.values, palette='viridis')
plt.xticks(rotation=45)
plt.title('Average Order Value per Country (Top 10)')
plt.xlabel('Country')
plt.ylabel('Average Order Value')
plt.show()
total_purchases_per_country = df.groupby('Country')['InvoiceNo'].nunique().sort_values(ascending=False)
top_purchase_countries = total_purchases_per_country.head(10)
plt.figure(figsize=(12,6))
sns.barplot(x=top_purchase_countries.index, y=top_purchase_countries.values, palette='magma')
plt.xticks(rotation=45)
plt.title('Total Number of Purchases per Country (Top 10)')
plt.xlabel('Country')
plt.ylabel('Total Purchases')
plt.show()"
Ipl_EDA.pdf,"import pandas as pd
ipl_auction_df = pd.read_csv(""Desktop/3rd sem/Data Analytics/ipl_auction_dataset.csv"")
type(ipl_auction_df)
list(ipl_auction_df.columns)
ipl_auction_df.head(5).transpose()
ipl_auction_df.shape
ipl_auction_df.info()
ipl_auction_df[['PLAYER NAME', 'SOLD PRICE']].sort_values('SOLD PRICE', ascending=False)[0:5]
soldprice_by_age_role = ipl_auction_df.groupby(['AGE', 'PLAYING ROLE'])['SOLD PRICE'].mean().reset_index()
soldprice_by_age = ipl_auction_df.groupby('AGE')['SOLD PRICE'].mean().reset_index()
soldprice_comparison = soldprice_by_age_role.merge(soldprice_by_age, on='AGE', how='outer')
soldprice_comparison"
automobile_for_record.pdf,"import pandas as pd
import numpy as np
df = pd.read_csv('automobile.csv')
df
df.head()
df.tail()
df.info()
df.describe()
group_body_drive = df.groupby(['body-style', 'drive-wheels'])
group_body_drive_df = group_body_drive.mean(numeric_only=True)
group_body_drive_df.head()
agg_result = df[['length', 'width', 'height', 'price']].agg(['mean', 'sum'])
df['mean_price_by_group'] = df.groupby(['body-style', 'drive-wheels'])['price'].transform('mean')
df[['body-style', 'drive-wheels', 'price', 'mean_price_by_group']].head()
crosstab_result = pd.crosstab(index=[df['make']], columns=[df['body-style'], df['drive-wheels'], df['num-of-doors']])
crosstab_result.head()"
Module_4_Timeseries.ipynb - Colab.pdf,"import os
import numpy as np
%matplotlib inline
from matplotlib import pyplot as plt
import seaborn as sns
zero_mean_series = np.random.normal(loc=0.0, scale=1., size=50)
zero_mean_series
g = sns.lineplot(data=zero_mean_series)
g.set_title('Zero mean model')
g.set_xlabel('Time index')
plt.show()
random_walk = np.cumsum(zero_mean_series)
random_walk
plt.figure(figsize=(16, 8))
g = sns.lineplot(data=random_walk)
g.set_title('Random Walk')
g.set_xlabel('Time index')
plt.show()
import pandas as pd
import numpy as np
df_power = pd.read_csv(""https://raw.githubusercontent.com/jenfly/opsd/master/data_opsd_germany_daily.csv"")
df_power.columns
df_power.tail(10)
df_power.index = pd.to_datetime(df_power['Date'])
import datetime
import pytz
df_power['Year'] = df_power.index.year
df_power['Month'] = df_power.index.month
df_power['Weekday Name'] = df_power.index.day_name()
df_power.sample(5, random_state=0)
df_power.loc['2017-01-01':'2017-12-30']
import matplotlib.pyplot as plt
import seaborn as sns
sns.set(rc={'figure.figsize':(16, 4)})
plt.rcParams['figure.dpi'] = 150
df_power['Consumption'].plot(linewidth=0.4)
cols_to_plot = ['Consumption', 'Solar', 'Wind']
axes = df_power[cols_to_plot].plot(marker='.', alpha=0.5, linestyle='None', figsize=(11, 9), subplots=True)
for ax in axes:
    ax.set_ylabel('Daily Totals (GWh)')
fig, ax = plt.subplots(figsize=(11, 9))
ax.plot(df_power.loc['2017-01':'2017-02', 'Consumption'], marker='o', linestyle='-')
ax.set_ylabel('Daily Consumption (GWh)')
ax.set_title('Jan-Feb 2017 Electricity Consumption')
ax.xaxis.set_major_locator(mdates.WeekdayLocator(byweekday=mdates.MONDAY))
ax.xaxis.set_major_formatter(mdates.DateFormatter('%b %d'))
fig, axes = plt.subplots(3, 1, figsize=(11, 10), sharex=True)
for name, ax in zip(['Consumption', 'Solar', 'Wind'], axes):
    sns.boxplot(data=df_power, x='Month', y=name, ax=ax)
    ax.set_ylabel('GWh')
    ax.set_title(name)
    if ax != axes[-1]:
        ax.set_xlabel('')"
Titanic EDA_for_record.pdf,"import pandas as pd
df = pd.read_csv(""Downloads/Titanic-Dataset.csv"")
df
df.head()
df.tail()
df.info()
df.describe()
df.isnull().sum()
Q1 = df['Fare'].quantile(0.25)
Q3 = df['Fare'].quantile(0.75)
IQR = Q3 - Q1
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR
df = df[(df['Fare'] >= lower_bound) & (df['Fare'] <= upper_bound)]
import matplotlib.pyplot as plt
df['Fare'].plot(kind='box', title='Fare Distribution')
plt.show()
df.loc[:, 'Cabin'] = df['Cabin'].apply(lambda x: 0 if pd.isnull(x) else 1)
df.isnull().sum()
df = df.copy()
bins = [0, 12, 18, 35, 60, 120]"